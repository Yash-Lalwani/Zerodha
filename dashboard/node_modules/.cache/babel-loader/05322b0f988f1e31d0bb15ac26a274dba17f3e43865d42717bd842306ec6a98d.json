{"ast":null,"code":"import React,{useContext,useState}from\"react\";import{Link}from\"react-router-dom\";import axios from\"axios\";import GeneralContext from\"./GeneralContext\";import\"./BuyActionWindow.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const BuyActionWindow=_ref=>{let{uid,mode=\"BUY\"}=_ref;const[stockQuantity,setStockQuantity]=useState(1);const[stockPrice,setStockPrice]=useState(0.0);const[submitting,setSubmitting]=useState(false);const[submitError,setSubmitError]=useState(\"\");const context=useContext(GeneralContext);const handleBuyClick=async()=>{const token=localStorage.getItem(\"token\");try{setSubmitting(true);setSubmitError(\"\");const baseUrl=process.env.REACT_APP_API_URL||\"http://localhost:3002\";await axios.post(\"\".concat(baseUrl,\"/newOrder\"),{name:uid,qty:Number(stockQuantity),price:Number(stockPrice),mode},{headers:token?{Authorization:\"Bearer \".concat(token)}:{}});// success: close\ncontext.closeBuyWindow();}catch(e){var _e$response,_e$response$data;setSubmitError((e===null||e===void 0?void 0:(_e$response=e.response)===null||_e$response===void 0?void 0:(_e$response$data=_e$response.data)===null||_e$response$data===void 0?void 0:_e$response$data.error)||(e===null||e===void 0?void 0:e.message)||\"Failed to place order\");}finally{setSubmitting(false);}};const handleCancelClick=()=>{context.closeBuyWindow();};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",id:\"buy-window\",draggable:\"true\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"regular-order\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"inputs\",children:[/*#__PURE__*/_jsxs(\"fieldset\",{children:[/*#__PURE__*/_jsx(\"legend\",{children:\"Qty.\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"qty\",id:\"qty\",onChange:e=>setStockQuantity(e.target.value),value:stockQuantity})]}),/*#__PURE__*/_jsxs(\"fieldset\",{children:[/*#__PURE__*/_jsx(\"legend\",{children:\"Price\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"price\",id:\"price\",step:\"0.05\",onChange:e=>setStockPrice(e.target.value),value:stockPrice})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"buttons\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Margin required \\u20B9140.65\"}),/*#__PURE__*/_jsxs(\"div\",{children:[submitError&&/*#__PURE__*/_jsx(\"span\",{className:\"text-danger me-3\",children:submitError}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-blue\",onClick:handleBuyClick,disabled:submitting,children:submitting?\"Placing...\":\"Buy\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-grey ms-2\",onClick:handleCancelClick,disabled:submitting,children:\"Cancel\"})]})]})]});};export default BuyActionWindow;","map":{"version":3,"names":["React","useContext","useState","Link","axios","GeneralContext","jsx","_jsx","jsxs","_jsxs","BuyActionWindow","_ref","uid","mode","stockQuantity","setStockQuantity","stockPrice","setStockPrice","submitting","setSubmitting","submitError","setSubmitError","context","handleBuyClick","token","localStorage","getItem","baseUrl","process","env","REACT_APP_API_URL","post","concat","name","qty","Number","price","headers","Authorization","closeBuyWindow","e","_e$response","_e$response$data","response","data","error","message","handleCancelClick","className","id","draggable","children","type","onChange","target","value","step","onClick","disabled"],"sources":["/Users/yash/Desktop/Zerodha/dashboard/src/components/BuyActionWindow.js"],"sourcesContent":["import React, { useContext, useState } from \"react\";\nimport { Link } from \"react-router-dom\";\n\nimport axios from \"axios\";\n\nimport GeneralContext from \"./GeneralContext\";\n\nimport \"./BuyActionWindow.css\";\n\nconst BuyActionWindow = ({ uid, mode = \"BUY\" }) => {\n  const [stockQuantity, setStockQuantity] = useState(1);\n  const [stockPrice, setStockPrice] = useState(0.0);\n  const [submitting, setSubmitting] = useState(false);\n  const [submitError, setSubmitError] = useState(\"\");\n\n  const context = useContext(GeneralContext);\n\n  const handleBuyClick = async () => {\n    const token = localStorage.getItem(\"token\");\n    try {\n      setSubmitting(true);\n      setSubmitError(\"\");\n      const baseUrl = process.env.REACT_APP_API_URL || \"http://localhost:3002\";\n      await axios.post(\n        `${baseUrl}/newOrder`,\n        {\n          name: uid,\n          qty: Number(stockQuantity),\n          price: Number(stockPrice),\n          mode,\n        },\n        { headers: token ? { Authorization: `Bearer ${token}` } : {} }\n      );\n      // success: close\n      context.closeBuyWindow();\n    } catch (e) {\n      setSubmitError(\n        e?.response?.data?.error || e?.message || \"Failed to place order\"\n      );\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  const handleCancelClick = () => {\n    context.closeBuyWindow();\n  };\n\n  return (\n    <div className=\"container\" id=\"buy-window\" draggable=\"true\">\n      <div className=\"regular-order\">\n        <div className=\"inputs\">\n          <fieldset>\n            <legend>Qty.</legend>\n            <input\n              type=\"number\"\n              name=\"qty\"\n              id=\"qty\"\n              onChange={(e) => setStockQuantity(e.target.value)}\n              value={stockQuantity}\n            />\n          </fieldset>\n          <fieldset>\n            <legend>Price</legend>\n            <input\n              type=\"number\"\n              name=\"price\"\n              id=\"price\"\n              step=\"0.05\"\n              onChange={(e) => setStockPrice(e.target.value)}\n              value={stockPrice}\n            />\n          </fieldset>\n        </div>\n      </div>\n\n      <div className=\"buttons\">\n        <span>Margin required â‚¹140.65</span>\n        <div>\n          {submitError && (\n            <span className=\"text-danger me-3\">{submitError}</span>\n          )}\n          <button\n            type=\"button\"\n            className=\"btn btn-blue\"\n            onClick={handleBuyClick}\n            disabled={submitting}\n          >\n            {submitting ? \"Placing...\" : \"Buy\"}\n          </button>\n          <button\n            type=\"button\"\n            className=\"btn btn-grey ms-2\"\n            onClick={handleCancelClick}\n            disabled={submitting}\n          >\n            Cancel\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default BuyActionWindow;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}